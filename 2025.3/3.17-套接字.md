# 概念

+ 网络设计模式
  + B/S
    + broswer - 浏览器 -> 客户端
    + server -> 服务器
    + 优势：
      + 跨平台
      + 开发成本低
    + 缺点：
      + 网络通信的时候必须使用 http 协议
        + http/https 应用层协议
      + 不能在磁盘缓存或者从磁盘加载大量数据
  + C/S
    + client -> 桌面应用程序
    + server-> 服务器
    + 特点：
      + 优点：
        + 使用的协议可以任意选择
        + 可以在本地缓存或者加载大量数据
      + 缺点：
        + 研发成本高
          + 在不同平台开发不同的客户端版本

+ 服务器
  + 硬件：配置较高的主机。
  + 软件：有一台主机，主机上运行了一个进程，这个进程可以处理网络协议，称为服务器。
  + 服务器开发
    + 工作不是去开发 web 服务器
    + 在一台装有服务器的主机上开发应用程序

+ IP和端口

  + IP 地址分类

    + 公网 IP
      + 可以访问 internet，是唯一的
      + 局域网 IP
        + 小的网络，比如一个路由器对应家里的网段
        + 在这个小的网络中 IP 是唯一的
        + 在这个局域网中的主机可以互相通信
        + 如果局域网和外网连接，那么局域网 IP  也可以连接外网

  + IP 协议

    + IPV4 - 现在应用很广泛的协议
    + IP 地址的点分十进制字符串
      + 192.168.1.100
    + 本质是一个整形数，4 字节，32 位
      + 通过三个点分成四份，每份一个字节
        + 字节的取值范围 0 - 255
        + 最大的 IP 地址：255.255.255.255
      + 可用的 IP 地址：
        + 2^32 - 1
      + 现在的IPV4的 IP 地址非常不够用，早在 2011 年就分配完了
    + IPV6 - 现在应用不是很广泛，将来主推的一种网络协议
    + 本质也是整形数，16 字节，128 bit
    + IP 地址表示：
      + 分为 8 份，每份 2 字节，使用 16 进制表示
    + IP 地址的个数;
      + 2^128 - 1

  + 相关的 linux 命令

    ```shell
    # 查看IP地址
    # linux
    $ ifconfig
    # windows
    $ ipconfig
    # 测试两台主机之间是否可用通信
    ping IP 地址
    ping 域名
    
    
    只要是 192.168.x.x 格式的都是局域网 IP
    公网 IP：11.13.45.67
    ```

  + 端口

    ```shell
    # 端口的本质？
    无符号短整型 -> unsigned short
    # 端口的取值范围？
    可以有多少个端口：0 ~ 2^16 - 1
    # 端口的作用?
    定位某台主机上运行的某个进程
    # 在电脑上运行 QQ 和 微信，小明给我发微信下消息，电脑上的微信马上就收到了消息，为什么？
    运行的 qq 和微信在启动时都绑定了不同的端口
    - 小明给我的微信发送数据
    - 需要知道我的 IP 地址 -> 定位我电脑
    - 如何定位电脑中的某一个进程 -> 通过端口h
    # 如何编写自己的应用程序分配端口？
    - 0 端口一般不用
    - 1 - 1024：系统用的
    - 1024 - 5000：系统预装的一些程序/一些常用的协议使用
    - 5001 - 65535：留给用户自定义的端口
    # 所有进程都需要有端口吗
    - 如果不通信，就不需要端口
    - 如果通信就需要端口
    ```

  + IP 和端口的使用

    ```shell
    # 通过 IP 定位环境网络中的主机，通过端口定位主机上的进程
    # 比如通过浏览器及逆行网络服务器访问
    # 服务器有 IP 地址/域名，服务器需要绑定端口
    # b/s -> 协议http -> 使用的端口是 80,https -> 443
    # 如果服务器使用的就是协议的默认端口，访问的时候端口是可以省略不写的
    http://www.baidu.com:80
    https://www.baidu.com:443
    
    # 域名：特殊的字符串，通过这个字符串就可以访问到 web 服务器了
    # 为什么绑定？方便记忆
    # 为什么？
    	- 域名需要先申请，然后需要和 web 服务器和外网 IP 进行绑定。
    	- 绑定成功后，才能通过域名访问到 web 服务器
    	- 通过域名去访问 web 服务器 -> 连接 dns 服务器 -> 查询域名和 IP 的对应关系 -> 得到了域名对应的 IP 地址 -> 通过 IP 地址访问 web 服务器
    ```

    ![](C:\Users\姜雨奇\AppData\Roaming\Typora\typora-user-images\image-20250317092151909.png)

# 协议格式

```shell
# 两台主机 A B
A 给 B 发送字符串 ‘hello world”,字符串不会以这种形态发送到 internet，需要在发送之前封装
封装是由操作系统或者调用的 API 自动完成的，程序员无需关心
如果程序员需要封装数据，一般是在应用层做处理，应用层数据可封装也可不封装

数据“hello world”在应用层进行发送
	1. 在应用层对这个字符串进行封装（可选，程序员做的）
	2. 传输层 -> 根据协议格式打包数据，tcp
	3. 网络层 -> 根据协议格式打包数据，ip
	4. 网络接口层 -> 根据协议格式打包数据，以太网帧协议
	
B 接收数据，拆包
	1. 网络接口层 -> 以太网帧协议拆开
	2. 得到了网络层
	……
	“hello world”
	
程序员只需要处理应用层
```

# 套接字通信

```shell
套接字通信就是网络协议，和语言无关，因为通信是基于协议的，所有的编程都要基于这些协议对数据进行处理

# 套接字是什么？
套接字是一套通信的接口，这个接口中封装了传输层协议（tcp/udp）。
接口就是 API，也就是一套函数

# socket（插座），套接字通信的组成部分？
1. 服务器端，插座的作用
	 - 被动接收连接的角色，不会主动发起连接
	 - 绑定 IP 和端口，这样客户端才能连接
	 
2. 客户端
	- 主动发起连接
	- 连接服务器需要地址
		- ip + 端口
		
3. 怎么用？ -> 所有编程语言的通信流程都是固定的
	- 服务器有通信流程
	- 客户端有通信流程
	
4. 套接字通信过程中要使用网络字节序
字节序：字符在内存额存储顺序，单位是字节，char 类型不需要研究字节序问题，大于一字节的都要研究字节序问题
字节序分类：
	- 主机字节序（小段）
	- 网络字节序（大端）
char -> 1 字节
int -> 4 字节
内存低地址位 -> 内存高地址位

5. 字符串有没有字节序问题？
没有

6. 为什么网络传输用大端？
这是一个标准，跨主机通信，不同的主机使用的默认字节序不同，按照本地默认字节序发送和解析数据可能会混乱，因此要有一个标准
```